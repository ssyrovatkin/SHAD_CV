from detection_and_metrics import calc_iou


def test_test():
    bboxes = [[[48, 26, 40, 100], [0.0, 0.0, 40.0, 100.0]],
              [[61, 20, 40, 100], [0.0, 0.0, 40.0, 100.0]],
              [[63, 140, 40, 100], [0.0, 0.0, 40.0, 100.0]],
              [[25, 55, 40, 100], [0.0, 0.0, 40.0, 100.0]],
              [[33, 18, 40, 100], [28.0, 24.0, 40.0, 100.0]],
              [[35, 118, 40, 100], [32.0, 20.0, 40.0, 100.0]],
              [[43, 5, 40, 100], [48.0, 12.0, 40.0, 100.0]],
              [[45, 110, 40, 100], [48.0, 12.0, 40.0, 100.0]],
              [[30, 30, 40, 100], [28.0, 32.0, 40.0, 100.0]],
              [[56, -10, 40, 100], [56.0, 0.0, 40.0, 100.0]],
              [[60, 92, 40, 100], [60.0, 44.0, 40.0, 100.0]]]
    ious = [0.0, 0.0, 0.0, 0.09215017064846416, 0.6985138004246284,
            0.009336361342417361, 0.6859852476290832, 0.009336361342417361,
            0.8709073900841908, 0.8181818181818182, 0.35135135135135137]
    err = 0
    for box, true_iou in zip(bboxes, ious):
        calculated_iou = calc_iou(box[0], box[1])
        diff = abs(calculated_iou - true_iou)
        if diff > 0.01:
            raise ValueError("Incorrect IOU for bboxes: " + str(box) + \
                             ", expected: "+ str(true_iou) + \
                             ", got:" + str(calculated_iou))
